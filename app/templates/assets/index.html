{% extends "layout.html" %}
{% block inner_content %}
{% if current_user.has_admin %}
<p>
    <a href="{{ url_for('assets.add') }}" class="btn btn-primary btn-raised">Add Asset</a>
</p>
{% endif %}
{% for asset in assets %}
<div class="panel panel-primary">
    <div class="panel-heading">
        <div class="col-md-12">
            <div class="col-md-4">Name:</div>
            <div class="col-md-8">
                <big><strong>{{ asset.name }}</strong></big>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="panel-body  panel-asset-body">
        <div class="col-md-12">
            <div class="col-md-4">Type:</div>
            <div class="col-md-8"><strong>{{ asset.type }}</strong></div>
        </div>
        <div class="col-md-12">
            <div class="col-md-4">Serial Number:</div>
            <div class="col-md-8"><strong>{{ asset.serial_no }}</strong></div>
        </div>
        <div class="col-md-12">
            <div class="col-md-4">Andela Serial Code:</div>
            <div class="col-md-8"><strong>{{ asset.code }}</strong></div>
        </div>
        <div class="col-md-12">
            <div class="col-md-4">Description:</div>
            <div class="col-md-8"><strong>{{ asset.description }}</strong></div>
        </div>
        {% if current_user.has_admin %}
            <div class="col-md-12">
                <div class="col-md-4">Date of purchase:</div>
                <div class="col-md-8"><strong>{{ asset.purchased_date }}</strong></div>
            </div>
            <div class="col-md-12">
                <div class="col-md-4">Added by:</div>
                <div class="col-md-8"><strong>{{ asset.added_by.name }}</strong></div>
            </div>
        {% endif %}
        {% if asset.is_assigned %}
            <div class="col-md-12">
                <hr>
            </div>
            {% if asset.check_assignee(current_user) or current_user.has_admin %}
            <div class="col-md-12">
                <div class="col-md-4">Return date:</div>
                <div class="col-md-8">
                    <strong>{{ asset.return_date_ }}</strong>
                    {% if asset.return_date_past %}
                        <span style="color:red;">(Item should have been returned already)</span>
                    {% endif %}
                    {% if asset.return_date_near %}
                        <span style="color:orange;">(Item return date is close)</span>
                    {% endif %}
                </div>
            </div>
            {% endif %}
            {% if current_user.has_admin %}
                <div class="col-md-12">
                    <div class="col-md-4">Assigned to:</div>
                    <div class="col-md-8"><strong>{{ asset.assignee.name }}</strong></div>
                </div>
            {% endif %}
        {% endif %}
        {% if asset.lost %}
            <div class="col-md-12">
                <div class="col-md-4">Lost:</div>
                <div class="col-md-8">
                    <big style="color:red;">
                        <strong>LOST</strong>
                    </big>
                </div>
            </div>
        {% endif %}
        <div class="col-md-12">
            {% if asset.is_assigned %}
                {% if asset.lost %}
                    {% if current_user.has_admin or asset.check_assignee(current_user) %}
                        <form class="inline-block" action="{{ url_for('assets.report_found', asset_id=asset.id) }}" method="post">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <input type="submit" class="btn btn-primary" value="Report Found">
                        </form>
                    {% endif %}
                {% else %}
                    {% if asset.check_assignee(current_user) %}
                    <form class="inline-block" action="{{ url_for('assets.report_lost', asset_id=asset.id) }}" method="post">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <input type="submit" class="btn btn-primary" value="Report Lost">
                    </form>
                    {% endif %}
                    {% if current_user.has_admin %}
                    <form class="inline-block" action="{{ url_for('assets.reclaim', asset_id=asset.id) }}" method="post">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <input type="submit" class="btn btn-primary" value="Reclaim">
                    </form>
                    {% endif %}
                {% endif %}
            {% elif current_user.has_admin %}
                <a class="btn btn-primary" href="{{ url_for('assets.assign', asset_id=asset.id) }}">Assign</a>
            {% endif %}
            {% if current_user.has_admin %}
                <a class="btn btn-primary" href="{{ url_for('assets.edit', asset_id=asset.id) }}">Edit</a>
            {% endif %}
        </div>
    </div>
</div>
{% else %}
<p><big><em>Empty</em></big></p>
{% endfor %}
{% endblock %}
